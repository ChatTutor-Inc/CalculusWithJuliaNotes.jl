{
  "hash": "5b72cb27c793b7c3c123beec05b17ef5",
  "result": {
    "markdown": "# Rational functions\n\n\n\nThis section uses the following add-on packages:\n\n``` {.julia .cell-code}\nusing CalculusWithJulia\nusing SymPy\nusing Plots\nimport Polynomials\nusing RealPolynomialRoots\n```\n\n\nThe `Polynomials` package is \"imported\" to avoid naming collisions with `SymPy`; names will need to be qualified.\n\n\n\n---\n\n\nA rational expression is the ratio of two polynomial expressions. Such expressions arise in many modeling situations. As many facts are known about polynomial expressions, much can be determined about rational expressions.  This section covers some additional details that arise when graphing such expressions.\n\n\n## Rational functions\n\n\nThe rational numbers are simply ratios of integers, of the form $p/q$ for non-zero $q$. A rational function is a ratio of *polynomial* *functions* of the form $p(x)/q(x)$, again $q$ is non-zero, but may have zeros.\n\n\nWe know that polynomials have nice behaviors due to the following facts:\n\n\n  * Behaviors at $-\\infty$, $\\infty$ are known just from the leading term.\n  * There are possible wiggles up and down, the exact behavior depends on intermediate terms, but there can be no more than $n-1$ wiggles.\n  * The number of real zeros is no more than $n$, the degree of the polynomial.\n\n\nRational functions are not quite so nice:\n\n\n  * behavior at $-\\infty$ and  $\\infty$ can be like a polynomial of any degree, including constants\n  * behaviour at any value x can blow up due to division by $0$ - rational functions, unlike polynomials, need not be always defined\n  * The function may or may not cross zero, even if the range includes every other point, as the graph of $f(x) =1/x$ will show.\n\n\nHere, as with our discussion on polynomials, we are interested for now in just a few properties:\n\n\n  * What happens to $f(x)$ when $x$ gets really big or really small (towards $\\infty$ or $-\\infty$)?\n  * What happens near the values where $q(x) = 0$?\n  * When is $f(x) = 0$?\n\n\nThese questions can often be answered with a graph, but with rational functions we will see that care must be taken to produce a useful graph.\n\n\nFor example, consider this graph generated from a simple rational function:\n\n\n\n$$\nf(x) = \\frac{(x-1)^2 \\cdot (x-2)}{(x+3) \\cdot (x-3)}.\n$$\n\n::: {.cell execution_count=4}\n``` {.julia .cell-code}\nf(x) = (x-1)^2 * (x-2) / ((x+3)*(x-3) )\nplot(f, -10, 10)\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n![](rational_functions_files/figure-html/cell-5-output-1.svg){}\n:::\n:::\n\n\nWe would be hard pressed to answer any of the three questions above from the graph, though, on inspection, we might think the strange spikes have something to do with $x$ values where $q(x)=0$.\n\n\nThe question of big or small $x$ is not answered well with this graph, as the spikes dominate the scale of the $y$-axis. Setting a much larger viewing window illuminates this question:\n\n::: {.cell execution_count=5}\n``` {.julia .cell-code}\nplot(f, -100, 100)\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n![](rational_functions_files/figure-html/cell-6-output-1.svg){}\n:::\n:::\n\n\nWe can see from this, that the function eventually looks like a slanted straight line. The *eventual* shape of the graph is something that can be determined just from the two leading terms.\n\n\nThe spikes haven't vanished completely. It is just that with only a few hundred points to make the graph, there aren't any values near enough to the problem to make a large spike. The spikes happen because the function has a *vertical asymptote* at these values. Though not quite right, it is reasonable to think of the graph being made by selecting a few hundred points in the specified domain, computing the corresponding $y$ values, plotting the pairs, and finally connecting the points with straight line segments.  Near a vertical asymptote the function values can be arbitrarily large in absolute values, though at the vertical asymptote the function is undefined. This graph doesn't show such detail.\n\n\nThe spikes will be related to the points where $q(x) = 0$, though not necessarily all of them – not all such points will produce a vertical asymptote.\n\n\nWhere the function crosses $0$ is very hard to tell from these two graphs. As well, other finer features, such as local peaks or valleys, when present, can be hard to identify as the $y$-scale is set to accommodate the  asymptotes. Working around the asymptotes requires some extra effort. Strategies are discussed herein.\n\n\n## Asymptotes\n\n\nFormally, an [asymptote](http://en.wikipedia.org/wiki/Asymptote) of a curve is a line such that the distance between the curve and the line approaches $0$ as they tend to infinity. Tending to infinity can happen as $x \\rightarrow \\pm \\infty$ *or* $y \\rightarrow \\pm \\infty$, the former being related to *horizontal asymptotes* or *slant asymptotes*, the latter being related to *vertical asymptotes*.\n\n\n### Behaviour as $x \\rightarrow \\infty$ or $x \\rightarrow -\\infty$.\n\n\nLet's look more closely at our example rational function using symbolic math.\n\n\nIn particular, let's rewrite the expression in terms of its numerator and denominator:\n\n::: {.cell execution_count=6}\n``` {.julia .cell-code}\n@syms x::real\nnum = (x-1)^2 * (x-2)\nden = (x+3) * (x-3)\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<span class=\"math-left-align\" style=\"padding-left: 4px; width:0; float:left;\"> \n\\[\n\\left(x - 3\\right) \\left(x + 3\\right)\n\\]\n</span>\n```\n:::\n:::\n\n\nEuclid's [division](https://en.wikipedia.org/wiki/Polynomial_greatest_common_divisor#Euclidean_division) algorithm can be used for polynomials $a(x)$ and $b(x)$ to produce $q(x)$ and $r(x)$ with $a = b\\cdot q + r$ *and* the degree of $r(x)$ is less than the degree of $b(x)$. This is in direct analogy to the division algorithm of integers, only there the value of the remainder, $r(x)$, satisfies $0 \\leq r < b$. Given $q(x)$ and $r(x)$ as above, we can reexpress the rational function\n\n\n\n$$\n\\frac{a(x)}{b(x)} = q(x)  + \\frac{r(x)}{b(x)}.\n$$\n\n\nThe rational expression on the right-hand side has larger degree in the denominator.\n\n\nThe division algorithm is implemented in `Julia` generically through the `divrem` method:\n\n::: {.cell execution_count=7}\n``` {.julia .cell-code}\nq, r = divrem(num, den)\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```\n(x - 4, 14*x - 38)\n```\n:::\n:::\n\n\nThis yields the decomposition of `num/den`:\n\n::: {.cell execution_count=8}\n``` {.julia .cell-code}\nq + r/den\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```{=html}\n<span class=\"math-left-align\" style=\"padding-left: 4px; width:0; float:left;\"> \n\\[\nx - 4 + \\frac{14 x - 38}{\\left(x - 3\\right) \\left(x + 3\\right)}\n\\]\n</span>\n```\n:::\n:::\n\n\nA similar result can be found using the `apart` function, which can be easier to use if the expression is not given in terms of a separate numerator and denominator.\n\n::: {.cell execution_count=9}\n``` {.julia .cell-code}\ng(x) = (x-1)^2 * (x-2) / ((x+3)*(x-3))  # as a function\nh = g(x)                                # a symbolic expression\napart(h)\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```{=html}\n<span class=\"math-left-align\" style=\"padding-left: 4px; width:0; float:left;\"> \n\\[\nx - 4 + \\frac{40}{3 \\left(x + 3\\right)} + \\frac{2}{3 \\left(x - 3\\right)}\n\\]\n</span>\n```\n:::\n:::\n\n\nThis decomposition breaks the rational expression into two pieces: $x-4$ and $40/(3x+9) + 2/(3x-9)$. The first piece would have a graph that is the line with slope $1$ and $y$-intercept $4$. As $x$ goes to $\\infty$, the second piece will clearly go towards $0,$ as this simple graph shows:\n\n::: {.cell execution_count=10}\n``` {.julia .cell-code}\nplot(apart(h) - (x - 4), 10, 100)\n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n![](rational_functions_files/figure-html/cell-11-output-1.svg){}\n:::\n:::\n\n\nSimilarly, a plot over $[-100, -10]$ would show decay towards $0$, though in that case from below. Combining these two facts then, it is now no surprise that the graph of the rational function $f(x)$ should approach a straight line, in this case $y=x-4$ as $x \\rightarrow \\pm \\infty$.\n\n\nWe can easily do most of this analysis without needing a computer or algebra. First, we should know the four eventual shapes of a polynomial, that the graph of $y=mx$ is a line with slope $m$, the graph of $y = c$ is a constant line at height $c$, and the graph of $y=c/x^m$, $m > 0$ will decay towards $0$ as $x \\rightarrow \\pm\\infty$. The latter should be clear, as $x^m$ gets big, so its reciprocal goes towards $0$.\n\n\nThe factored form, as $p$ is presented, is a bit hard to work with, rather we use the expanded form, which we get through the `cancel` function\n\n::: {.cell execution_count=11}\n``` {.julia .cell-code}\ncancel(h)\n```\n\n::: {.cell-output .cell-output-display execution_count=12}\n```{=html}\n<span class=\"math-left-align\" style=\"padding-left: 4px; width:0; float:left;\"> \n\\[\n\\frac{x^{3} - 4 x^{2} + 5 x - 2}{x^{2} - 9}\n\\]\n</span>\n```\n:::\n:::\n\n\nWe can see that the numerator is of degree $3$ and the denominator of degree $2$.  The leading terms are $x^3$ and $x^2$, respectively. If we were to pull those out we would get:\n\n\n\n$$\n\\frac{x^3 \\cdot (1 - 4/x + 5/x^2 - 2/x^3)}{x^2 \\cdot (1 - 9/x^2)}.\n$$\n\n\nThe terms $(1 - 4/x + 5/x^2 - 2/x^3)$ and $(1 - 9/x^2)$ go towards $1$ as $x \\rightarrow \\pm \\infty$, as each term with $x$ goes towards $0$. So the dominant terms comes from the ratio of the leading terms, $x^3$ and $x^2$. This ratio is $x$, so their will be an asymptote around a line with slope $1$. (The fact that the asymptote is $y=x-4$ takes a bit more work, as a division step is needed.)\n\n\nJust by looking at the ratio of the two leading terms, the behaviour as $x \\rightarrow \\pm \\infty$ can be discerned. If this ratio is of:\n\n\n  * the form $c x^m$ with $m > 1$ then the shape will follow the polynomial growth of of the monomial $c x^m$.\n  * the form $c x^m$ with  $m=1$ then there will be a line with slope $c$ as a *slant asymptote*.\n  * the form $cx^0$ with  $m=0$ (or just $c$) then there will be a *horizontal asymptote* $y=c$.\n  * the form $c/x^{m}$ with $m  >  0$ then there will be a horizontal asymptote $y=0$, or the $y$ axis.\n\n\nTo expand on the first points where the degree of the numerator is greater than that of the denominator, we have from the division algorithm that if $a(x)$ is the numerator and $b(x)$ the denominator, then $a(x)/b(x) = q(x) + r(x)/b(x)$ where the degree of $b(x)$ is greater than the degree of $r(x)$, so the right-most term will have a horizontal asymptote of $0$. This says that the graph will eventually approach the graph of $q(x)$, giving more detail than just saying it follows the shape of the leading term of $q(x)$, at the expense of the work required to find $q(x)$.\n\n\n### Examples\n\n\nConsider the rational expression\n\n\n\n$$\n\\frac{17x^5 - 300x^4 - 1/2}{x^5 - 2x^4 + 3x^3 - 4x^2 + 5}.\n$$\n\n\nThe leading term of the numerator is $17x^5$ and the leading term of the denominator is $x^5$. The ratio is $17$ (or $17x^0 = 17x^{5-5}$). As such, we would have a horizontal asymptote $y=17$.\n\n\n---\n\nIf we consider instead this rational expression:\n\n\n\n$$\n\\frac{x^5 - 2x^4 + 3x^3 - 4x^2 + 5}{5x^4 + 4x^3 + 3x^2 + 2x + 1}\n$$\n\n\nThen we can see that the ratio of the leading terms is $x^5 / (5x^4) = (1/5)x$. We expect a slant asymptote with slope $1/5$, though we would need to divide to see the exact intercept. This is found with, say:\n\n::: {.cell hold='true' execution_count=12}\n``` {.julia .cell-code}\np = (x^5 - 2x^4 + 3x^3 - 4x^2 + 5) / (5x^4 + 4x^3 + 3x^2 + 2x + 1)\nquo, rem = divrem(numerator(p), denominator(p))  # or apart(p)\nquo\n```\n\n::: {.cell-output .cell-output-display execution_count=13}\n```{=html}\n<span class=\"math-left-align\" style=\"padding-left: 4px; width:0; float:left;\"> \n\\[\n\\frac{x}{5} - \\frac{14}{25}\n\\]\n</span>\n```\n:::\n:::\n\n\n---\n\n\nThe rational function\n\n\n\n$$\n\\frac{5x^3 + 6x^2 + 2}{x-1}\n$$\n\n\nhas decomposition $5x^2 + 11x + 11 + 13/(x-1)$:\n\n::: {.cell execution_count=13}\n``` {.julia .cell-code}\ntop = 5x^3 + 6x^2 +2\nbottom = x-1\nquo, rem = divrem(top, bottom)\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```\n(5*x^2 + 11*x + 11, 13)\n```\n:::\n:::\n\n\nThe graph of has nothing in common with the graph of the quotient for small $x$\n\n::: {.cell execution_count=14}\n``` {.julia .cell-code}\nplot(top/bottom, -3, 3)\nplot!(quo, -3, 3)\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n![](rational_functions_files/figure-html/cell-15-output-1.svg){}\n:::\n:::\n\n\nBut the graphs do match for large $x$:\n\n::: {.cell execution_count=15}\n``` {.julia .cell-code}\nplot(top/bottom, 5, 10)\nplot!(quo, 5, 10)\n```\n\n::: {.cell-output .cell-output-display execution_count=16}\n![](rational_functions_files/figure-html/cell-16-output-1.svg){}\n:::\n:::\n\n\n---\n\nFinally, consider this rational expression in factored form:\n\n\n\n$$\n\\frac{(x-2)^3\\cdot(x-4)\\cdot(x-3)}{(x-5)^4 \\cdot (x-6)^2}.\n$$\n\n\nBy looking at the powers we can see that the leading term of the numerator will the $x^5$ and the leading term of the denominator $x^6$. The ratio is $1/x^1$. As such, we expect the $y$-axis as a horizontal asymptote:\n\n\n#### Partial fractions\n\n\nThe `apart` function was useful to express a rational function in terms of a polynomial plus additional rational functions whose horizontal asymptotes are $0$.  This function computes the partial fraction [decomposition](https://en.wikipedia.org/wiki/Partial_fraction_decomposition) of a rational function. Outside of the initial polynomial, this decomposition is a reexpression of a rational function into a sum of rational functions, where the denominators are *irreducible*, or unable to be further factored (non-trivially) and the numerators have lower degree than the denominator. Hence the horizontal asymptotes of $0$.\n\n\nTo see another example we have:\n\n::: {.cell hold='true' execution_count=16}\n``` {.julia .cell-code}\np = (x-1)*(x-2)\nq = (x-3)^3 * (x^2 - x - 1)\napart(p/q)\n```\n\n::: {.cell-output .cell-output-display execution_count=17}\n```{=html}\n<span class=\"math-left-align\" style=\"padding-left: 4px; width:0; float:left;\"> \n\\[\n\\frac{2 x - 1}{25 \\left(x^{2} - x - 1\\right)} - \\frac{2}{25 \\left(x - 3\\right)} + \\frac{1}{5 \\left(x - 3\\right)^{2}} + \\frac{2}{5 \\left(x - 3\\right)^{3}}\n\\]\n</span>\n```\n:::\n:::\n\n\nThe denominator, $q$, has factors $x-3$ and $x^2 - x - 1$, each irreducible. The answer is expressed in terms of a sum of rational functions each with a denominator coming from one of these factors, possibly with a power.\n\n\n### Vertical asymptotes\n\n\nAs just discussed, the graph of $1/x$ will have a horizontal asymptote. However it will also show a spike at $0$:\n\n::: {.cell execution_count=17}\n``` {.julia .cell-code}\nplot(1/x, -1, 1)\n```\n\n::: {.cell-output .cell-output-display execution_count=18}\n![](rational_functions_files/figure-html/cell-18-output-1.svg){}\n:::\n:::\n\n\nAgain, this spike is an artifact of the plotting algorithm. The $y$ values for $x$-values just smaller than $0$ are large negative values and the $x$ values just larger than $0$ produce large, positive $y$ values.\n\n\nThe two points with $x$ components closest to $0$ are connected with a line, though that is misleading.  Here we deliberately use far fewer points to plot $1/x$ to show how this happens:\n\n::: {.cell hold='true' execution_count=18}\n``` {.julia .cell-code}\nf(x) = 1/x\nxs = range(-1, 1, length=12)\nys = f.(xs)\nplot(xs, ys)\nscatter!(xs, ys)\n```\n\n::: {.cell-output .cell-output-display execution_count=19}\n![](rational_functions_files/figure-html/cell-19-output-1.svg){}\n:::\n:::\n\n\nThe line $x = 0$ is a *vertical asymptote* for the graph of $1/x$. As $x$ values get close to $0$ from the right, the $y$ values go towards $\\infty$ and as the $x$ values get close to $0$ on the left, the $y$ values go towards $-\\infty$.\n\n\nThis has everything to do with the fact that $0$ is a root of the denominator.\n\n\nFor a rational function $p(x)/q(x)$, the roots of $q(x)$ may or may not lead to vertical asymptotes. For a root $c$ if $p(c)$ is not zero then the line $x=c$ will be a vertical asymptote. If $c$ is a root of both $p(x)$ and $q(x)$, then we can rewrite the expression as:\n\n\n\n$$\n\\frac{p(x)}{q(x)} = \\frac{(x-c)^m r(x)}{(x-c)^n s(x)},\n$$\n\n\nwhere both $r(c)$ and $s(c)$ are non zero. Knowing $m$ and $n$ (the multiplicities of the root $c$) allows the following to be said:\n\n\n  * If $m < n$ then $x=c$ will be a vertical asymptote.\n  * If $m \\geq n$ then $x=c$ will not be vertical asymptote. (The value $c$ will be known as a removable singularity). In this case, the graph of $p(x)/q(x)$ and the graph of $(x-c)^{m-n}r(x)/s(x)$ will differ, though very slightly, as the latter will include a value for $x=c$, whereas $x=c$ is not in the domain of $p(x)/q(x)$.\n\n\nFinding the multiplicity may or may not be hard, but there is a very kludgy quick check that is often correct. With `Julia`, if you have a rational function that has `f(c)` evaluate to `Inf` or `-Inf` then there will be a vertical asymptote. If the expression evaluates to `NaN`, more analysis is needed. (The value of `0/0` is `NaN`, where as `1/0` is `Inf`.)\n\n\nFor example, the function $f(x) = ((x-1)^2 \\cdot (x-2)) / ((x+3) \\cdot(x-3))$ has vertical asymptotes at $-3$ and $3$, as its graph illustrated. Without the graph we could see this as well:\n\n::: {.cell hold='true' execution_count=19}\n``` {.julia .cell-code}\nf(x) = (x-1)^2 * (x-2) / ((x+3)*(x-3) )\nf(3), f(-3)\n```\n\n::: {.cell-output .cell-output-display execution_count=20}\n```\n(Inf, -Inf)\n```\n:::\n:::\n\n\n#### Graphing with vertical asymptotes\n\n\nAs seen in several graphs, the basic plotting algorithm does a poor job with vertical asymptotes. For example, it may erroneously connect their values with a steep vertical line, or the $y$-axis scale can get so large as to make reading the rest of the graph impossible. There are some tricks to work around this.\n\n\nConsider again the function $f(x) = ((x-1)^2 \\cdot (x-2)) / ((x+3) \\cdot(x-3))$. Without much work, we can see that $x=3$ and $x=-3$ will be vertical asymptotes and there will be a slant asymptote with slope $1$. How to graph this?\n\n\nWe can avoid the vertical asymptotes in our viewing window. For example we could look at the area between the vertical asymptotes, by plotting over $(-2.9, 2.9)$, say:\n\n::: {.cell execution_count=20}\n``` {.julia .cell-code}\n𝒇(x) = (x-1)^2 * (x-2) / ((x+3)*(x-3) )\nplot(𝒇, -2.9, 2.9)\n```\n\n::: {.cell-output .cell-output-display execution_count=21}\n![](rational_functions_files/figure-html/cell-21-output-1.svg){}\n:::\n:::\n\n\nThis backs off by $\\delta = 0.1$. As we have that $3 - 2.9$ is $\\delta$ and $1/\\delta$ is 10, the $y$ axis won't get too large, and indeed it doesn't.\n\n\nThis graph doesn't show well the two zeros at $x=1$ and $x=2$, for that a narrower viewing window is needed.  By successively panning throughout the interesting part of the graph, we can get a view of the function.\n\n\nWe can also clip the `y` axis. The `plot` function can be passed an argument `ylims=(lo, hi)` to limit which values are plotted. With this, we can have:\n\n::: {.cell hold='true' execution_count=21}\n``` {.julia .cell-code}\nplot(𝒇, -5, 5, ylims=(-20, 20))\n```\n\n::: {.cell-output .cell-output-display execution_count=22}\n![](rational_functions_files/figure-html/cell-22-output-1.svg){}\n:::\n:::\n\n\nThis isn't ideal, as the large values are still computed, just the viewing window is clipped. This leaves the vertical asymptotes still effecting the graph.\n\n\nThere is another way, we could ask `Julia` to not plot $y$ values that get too large. This is not a big request.  If instead of the value of `f(x)` - when it is large - -we use `NaN` instead, then the connect-the-dots algorithm will skip those values.\n\n\nThis was discussed in an earlier section where the `rangeclamp` function was introduced to replace large values of `f(x)` (in absolute values) with `NaN`.\n\n::: {.cell execution_count=22}\n``` {.julia .cell-code}\nplot(rangeclamp(𝒇, 30), -25, 25)  # rangeclamp is in the CalculusWithJulia package\n```\n\n::: {.cell-output .cell-output-display execution_count=23}\n![](rational_functions_files/figure-html/cell-23-output-1.svg){}\n:::\n:::\n\n\nWe can see the general shape of $3$ curves broken up by the vertical asymptotes. The two on the side heading off towards the line $x-4$ and the one in the middle. We still can't see the precise location of the zeros, but that wouldn't be the case with most graphs that show asymptotic behaviors. However, we can clearly tell where to \"zoom in\" were those of interest.\n\n\n### Sign charts\n\n\nWhen sketching graphs of rational functions by hand, it is useful to use sign charts. A sign chart of a function indicates when the function is positive, negative, $0$, or undefined. It typically is represented along the lines of this one for $f(x) = x^3 - x$:\n\n\n\n```{verbatim}\n    -    0   +   0   -   0   +\n< ----- -1 ----- 0 ----- 1 ----- >\n```\n\n\nThe usual recipe for construction follows these steps:\n\n\n  * Identify when the function is $0$ or undefined. Place those values on a number line.\n  * Identify \"test points\" within each implied interval (these are $(-\\infty, -1)$, $(-1,0)$, $(0,1)$, and $(1, \\infty)$ in the example) and check for the sign of $f(x)$ at these test points. Write in `-`, `+`, `0`, or `*`, as appropriate. The value comes from the fact that \"continuous\" functions may only change sign when they cross $0$ or are undefined.\n\n\nWith the computer, where it is convenient to draw a graph, it might be better to emphasize the sign on the graph of the function. The `sign_chart` function from `CalculusWithJulia` does this by numerically identifying points where the function is $0$ or $\\infty$ and indicating the sign as $x$ crosses over these points.\n\n::: {.cell execution_count=23}\n\n::: {.cell-output .cell-output-display execution_count=24}\n```\nsign_chart (generic function with 1 method)\n```\n:::\n:::\n\n\n::: {.cell hold='true' execution_count=24}\n``` {.julia .cell-code}\nf(x) = x^3 - x\nsign_chart(f, -3/2, 3/2)\n```\n\n::: {.cell-output .cell-output-display execution_count=25}\n```\n3-element Vector{NamedTuple{(:∞0, :sign_change), Tuple{Float64, String}}}:\n (∞0 = -1.0, sign_change = \"- → +\")\n (∞0 = 0.0, sign_change = \"+ → -\")\n (∞0 = 1.0, sign_change = \"- → +\")\n```\n:::\n:::\n\n\n## Pade approximate\n\n\nOne area where rational functions are employed is in approximating functions. Later, the Taylor polynomial will be seen to be a polynomial that approximates well a function (where \"well\" will be described later). The Pade approximation is similar, though uses a rational function for the form $p(x)/q(x)$, where $q(0)=1$ is customary.\n\n\nSome example approximations are\n\n\n\n$$\n\\sin(x) \\approx \\frac{x - 7/60 \\cdot x^3}{1 + 1/20 \\cdot x^2}\n$$\n\n\nand\n\n\n\n$$\n\\tan(x) \\approx \\frac{x - 1/15 \\cdot x^3}{1 - 2/5 \\cdot x^2}\n$$\n\n\nWe can look graphically at these approximations:\n\n::: {.cell execution_count=25}\n``` {.julia .cell-code}\nsin_p(x) = (x - (7/60)*x^3) / (1 + (1/20)*x^2)\ntan_p(x) = (x - (1/15)*x^3) / (1 - (2/5)*x^2)\nplot(sin, -pi, pi)\nplot!(sin_p, -pi, pi)\n```\n\n::: {.cell-output .cell-output-display execution_count=26}\n![](rational_functions_files/figure-html/cell-26-output-1.svg){}\n:::\n:::\n\n\n::: {.cell execution_count=26}\n``` {.julia .cell-code}\nplot(tan, -pi/2 + 0.2, pi/2 - 0.2)\nplot!(tan_p, -pi/2 + 0.2, pi/2 - 0.2)\n```\n\n::: {.cell-output .cell-output-display execution_count=27}\n![](rational_functions_files/figure-html/cell-27-output-1.svg){}\n:::\n:::\n\n\n## The `Polynomials` package for rational functions\n\n\nIn the following, we import some functions from the `Polynomials` package. We avoided loading the entire namespace, as there are conflicts with `SymPy`. Here we import some useful functions and the `Polynomial` constructor:\n\n``` {.julia .cell-code}\nimport Polynomials: Polynomial, variable, lowest_terms, fromroots, coeffs\n```\n\n\nThe `Polynomials` package has support for rational functions. The `//` operator can be used to create rational expressions:\n\n::: {.cell execution_count=28}\n``` {.julia .cell-code}\n𝒙 = variable()\n𝒑 = (𝒙-1)*(𝒙-2)^2\n𝒒 = (𝒙-2)*(𝒙-3)\n𝒑𝒒 = 𝒑 // 𝒒\n```\n\n::: {.cell-output .cell-output-display execution_count=29}\n```\n(-4 + 8*x - 5*x^2 + x^3) // (6 - 5*x + x^2)\n```\n:::\n:::\n\n\nA rational expression is a formal object; a rational function the viewpoint that this object will be evaluated by substituting  values for the indeterminate. Rational expressions made within `Polynomials` are evaluated just like functions:\n\n::: {.cell execution_count=29}\n``` {.julia .cell-code}\n𝒑𝒒(4)  # p(4)/q(4)\n```\n\n::: {.cell-output .cell-output-display execution_count=30}\n```\n6.0\n```\n:::\n:::\n\n\nThe rational expressions are not in lowest terms unless requested through the `lowest_terms` method:\n\n::: {.cell execution_count=30}\n``` {.julia .cell-code}\nlowest_terms(𝒑𝒒)\n```\n\n::: {.cell-output .cell-output-display execution_count=31}\n```\n(1.999999999999998 - 2.9999999999999982*x + 0.9999999999999996*x^2) // (-2.9999999999999973 + 1.0*x)\n```\n:::\n:::\n\n\nFor polynomials as simple as these, this computation is not a problem, but there is the very real possibility that the lowest term computation may be incorrect. Unlike `SymPy` which factors symbolically, `lowest_terms` uses a numeric algorithm and does not, as would be done by hand or with `SymPy`, factor the polynomial and then cancel common factors.\n\n\nThe distinction between the two expressions is sometimes made; the initial expression is not defined at $x=2$; the reduced one is, so the two are not identical when viewed as functions of the variable $x$.\n\n\nRational expressions include polynomial expressions, just as the rational numbers include the integers. The identification there is to divide by $1$, thinking of $3$ as $3/1$. In `Julia`, we would just use\n\n::: {.cell execution_count=31}\n``` {.julia .cell-code}\n3//1\n```\n\n::: {.cell-output .cell-output-display execution_count=32}\n```\n3//1\n```\n:::\n:::\n\n\nThe integer can be recovered from the rational number using `numerator`:\n\n::: {.cell execution_count=32}\n``` {.julia .cell-code}\nnumerator(3//1)\n```\n\n::: {.cell-output .cell-output-display execution_count=33}\n```\n3\n```\n:::\n:::\n\n\nSimilarly, we can divide a polynomial by the polynomial $1$, which in `Julia` is returned by `one(p)`, to produce a rational expression:\n\n::: {.cell execution_count=33}\n``` {.julia .cell-code}\npp = 𝒑 // one(𝒑)\n```\n\n::: {.cell-output .cell-output-display execution_count=34}\n```\n(-4 + 8*x - 5*x^2 + x^3) // (1)\n```\n:::\n:::\n\n\nAnd as with rational numbers, `p` is recovered by `numerator`:\n\n::: {.cell execution_count=34}\n``` {.julia .cell-code}\nnumerator(pp)\n```\n\n::: {.cell-output .cell-output-display execution_count=35}\n```{=html}\n&#45;4 &#43; 8&#8729;x &#45; 5&#8729;x<sup>2</sup> &#43; x<sup>3</sup>\n```\n:::\n:::\n\n\nOne difference is the rational number `3//1` also represents other expressions, say `6/2` or `12/4`, as `Julia`'s rational numbers are presented in lowest terms, unlike the rational expressions in `Polynomials`.\n\n\nRational functions also have a plot recipe defined for them that attempts to ensure the basic features are identifiable. As previously discussed, a plot of a rational function can require some effort to avoid the values associated to vertical asymptotes taking up too many of the available vertical pixels in a graph.\n\n\nFor the polynomial `pq` above, we have from observation that $1$ and $2$ will be zeros and $x=3$ a vertical asymptote. We also can identify a slant asymptote with slope $1$. These are hinted at in this graph:\n\n::: {.cell execution_count=35}\n``` {.julia .cell-code}\nplot(𝒑𝒒)\n```\n\n::: {.cell-output .cell-output-display execution_count=36}\n![](rational_functions_files/figure-html/cell-36-output-1.svg){}\n:::\n:::\n\n\nTo better see the zeros, a plot over a narrower interval, say $[0,2.5]$, would be encouraged; to better see the slant asymptote, a plot over a wider interval, say $[-10,10]$, would be encouraged.\n\n\nFor one more example of the default plot recipe, we redo the graphing of the rational expression we earlier plotted with `rangeclamp`:\n\n::: {.cell hold='true' execution_count=36}\n``` {.julia .cell-code}\np,q = fromroots([1,1,2]), fromroots([-3,3])\nplot(p//q)\n```\n\n::: {.cell-output .cell-output-display execution_count=37}\n![](rational_functions_files/figure-html/cell-37-output-1.svg){}\n:::\n:::\n\n\n##### Example: transformations of polynomials; real roots\n\n\nWe have seen some basic transformations of functions such as shifts and scales. For a polynomial expression we can implement these as follows, taking advantage of polynomial evaluation:\n\n::: {.cell hold='true' execution_count=37}\n``` {.julia .cell-code}\nx = variable()\np = 3 + 4x + 5x^2\na = 2\np(a*x), p(x+a) # scale, shift\n```\n\n::: {.cell-output .cell-output-display execution_count=38}\n```\n(Polynomial(3 + 8*x + 20*x^2), Polynomial(31 + 24*x + 5*x^2))\n```\n:::\n:::\n\n\nA different polynomial transformation is inversion, or the mapping $x^d \\cdot p(1/x)$ where $d$ is the degree of $p$. This will yield a polynomial, as perhaps this example will convince you:\n\n::: {.cell hold='true' execution_count=38}\n``` {.julia .cell-code}\np = Polynomial([1, 2, 3, 4, 5])\nd = Polynomials.degree(p)  # degree is in SymPy and Polynomials, indicate which\npp = p // one(p)\nx = variable(pp)\nq = x^d * pp(1/x)\nlowest_terms(q)\n```\n\n::: {.cell-output .cell-output-display execution_count=39}\n```\n(5.0 + 4.0*x + 3.0*x^2 + 2.0*x^3 + 1.0*x^4) // (1.0)\n```\n:::\n:::\n\n\nWe had to use a rational expression so that division by the variable was possible. The above indicates that the new polynomial, $q$, is constructed from $p$ by **reversing** the coefficients.\n\n\nInversion is like a funhouse mirror, flipping around parts of the polynomial. For example, the interval $[1/4,1/2]$ is related to the interval $[2,4]$. Of interest here, is that if $p(x)$ had a root, $r$, in $[1/4,1/2]$ then $q(x) = x^d \\cdot p(1/x)$ would have a root in $[2,4]$ at $1/r$.\n\n\nSo these three transformations – scale, shift, and inversion – can be defined for polynomials.\n\n\nCombined, the three can be used to create a [Mobius transformation](https://en.wikipedia.org/wiki/M%C3%B6bius_transformation). For two values $a$ and $b$, consider the polynomial derived from $p$ (again `d=degree(p)`) by:\n\n\n\n$$\nq = (x+1)^d \\cdot p(\\frac{ax + b}{x + 1}).\n$$\n\n\nHere is a non-performant implementation as a `Julia` function:\n\n::: {.cell execution_count=39}\n``` {.julia .cell-code}\nfunction mobius_transformation(p, a, b)\n  x = variable(p)\n  p = p(x + a)   # shift\n  p = p((b-a)*x) # scale\n  p = Polynomial(reverse(coeffs(p))) # invert\n  p = p(x + 1)   # shift\n  p\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=40}\n```\nmobius_transformation (generic function with 1 method)\n```\n:::\n:::\n\n\nWe can verify this does what we want through example with the previously defined `p`:\n\n::: {.cell execution_count=40}\n``` {.julia .cell-code}\n𝐩 = Polynomial([1, 2, 3, 4, 5])\n𝐪 = mobius_transformation(𝐩, 4, 6)\n```\n\n::: {.cell-output .cell-output-display execution_count=41}\n```{=html}\n7465 &#43; 20280&#8729;x &#43; 20670&#8729;x<sup>2</sup> &#43; 9368&#8729;x<sup>3</sup> &#43; 1593&#8729;x<sup>4</sup>\n```\n:::\n:::\n\n\nAs contrasted with\n\n::: {.cell hold='true' execution_count=41}\n``` {.julia .cell-code}\na, b = 4, 6\n\npq = 𝐩 // one(𝐩)\nx = variable(pq)\nd = Polynomials.degree(𝐩)\nnumerator(lowest_terms( (x + 1)^2 * pq((a*x + b)/(x + 1))))\n```\n\n::: {.cell-output .cell-output-display execution_count=42}\n```{=html}\n7465.000000001552 &#43; 20280.00000000283&#8729;x &#43; 20670.00000000175&#8729;x<sup>2</sup> &#43; 9368.000000000367&#8729;x<sup>3</sup> &#43; 1593.0000000000002&#8729;x<sup>4</sup>\n```\n:::\n:::\n\n\n---\n\n\nNow, why is this of any interest?\n\n\nMobius transforms are used to map regions into other regions. In this special case, the transform $\\phi(x) = (ax + b)/(x + 1)$ takes the interval $[0,\\infty]$ and sends it to $[a,b]$  ($0$ goes to $(a\\cdot 0 + b)/(0+1) = b$, whereas $\\infty$ goes to $ax/x \\rightarrow a$). Using this, if $p(u) = 0$, with $q(x) = (x-1)^d p(\\phi(x))$,  then setting $u = \\phi(x)$ we have $q(x) = (\\phi^{-1}(u)+1)^d p(\\phi(\\phi^{-1}(u))) =  (\\phi^{-1}(u)+1)^d \\cdot  p(u) =  (\\phi^{-1}(u)+1)^d \\cdot 0 = 0$. That is, a zero of $p$ in $[a,b]$ will appear as a zero of $q$ in $[0,\\infty)$ at $\\phi^{-1}(u)$.\n\n\nThe Descartes rule of signs applied to $q$ then will give a bound on the number of possible roots of $p$ in the interval $[a,b]$. In the example we did, the Mobius transform for $a=4, b=6$ is $15 - x - 11x^2 - 3x^3$ with $1$ sign change, so there must be exactly $1$ real root of $p=(x-1)(x-3)(x-5)$ in the interval $[4,6]$, as we can observe from the factored form of $p$.\n\n\nSimilarly, we can see there are $2$ or $0$ roots for $p$ in the interval $[2,6]$ by counting the two sign changes here:\n\n::: {.cell execution_count=42}\n``` {.julia .cell-code}\nmobius_transformation(𝐩, 2,6)\n```\n\n::: {.cell-output .cell-output-display execution_count=43}\n```{=html}\n7465 &#43; 10700&#8729;x &#43; 5790&#8729;x<sup>2</sup> &#43; 1404&#8729;x<sup>3</sup> &#43; 129&#8729;x<sup>4</sup>\n```\n:::\n:::\n\n\nThis observation, along with a detailed analysis provided by [Kobel, Rouillier, and Sagraloff](https://dl.acm.org/doi/10.1145/2930889.2930937) provides a means to find intervals that enclose the real roots of a polynomial.\n\n\nThe basic algorithm, as presented next, is fairly simple to understand, and hints at the bisection algorithm to come. It is due to Akritas and Collins. Suppose you know the only possible positive real roots are between $0$ and $M$ *and* no roots are repeated. Find the transformed polynomial over $[0,M]$:\n\n\n  * If there are no sign changes, then there are no roots of $p$ in $[0,M]$.\n  * If there is one sign change, then there is a single root of $p$ in $[0,M]$. The interval $[0,M]$ is said to isolate the root (and the actual root can then be found by other means)\n  * If there is more than one sign change, divide the interval in two ($[0,M/2]$ and $[M/2,M]$, say) and apply the same consideration to each.\n\n\nEventually, **mathematically** this will find isolating intervals for each positive real root. (The negative ones can be similarly isolated.)\n\n\nApplying these steps to $p$ with an initial interval, say $[0,9]$, we would have:\n\n::: {.cell hold='true' execution_count=43}\n``` {.julia .cell-code}\np = fromroots([1,3,5])               #  (x-1)⋅(x-3)⋅(x-5) = -15 + 23*x - 9*x^2 + x^3\nmobius_transformation(p, 0, 9) # 3\nmobius_transformation(p, 0, 9//2)    # 2\nmobius_transformation(p, 9//2, 9)    # 1 (and done)\nmobius_transformation(p, 0, 9//4)    # 1 (and done)\nmobius_transformation(p, 9//4, 9//2) # 1 (and done)\n```\n\n::: {.cell-output .cell-output-display execution_count=44}\n```{=html}\n&#45;21//8 &#45; 225//16&#8729;x &#43; 81//32&#8729;x<sup>2</sup> &#43; 165//64&#8729;x<sup>3</sup>\n```\n:::\n:::\n\n\nSo the three roots ($1$, $3$, $5$) are isolated by $[0, 9/4]$, $[9/4, 9/2]$, and $[9/2, 9]$.\n\n\n### The `RealPolynomialRoots` package.\n\n\nFor square-free polynomials, the `RealPolynomialRoots` package implements a basic version of the  paper of [Kobel, Rouillier, and Sagraloff](https://dl.acm.org/doi/10.1145/2930889.2930937) to identify the real roots of a polynomial using the Descartes rule of signs and the Möbius transformations just described.\n\n\nThe `ANewDsc` function takes a collection of coefficients representing a polynomial and returns isolating intervals for each real root. For example:\n\n::: {.cell execution_count=44}\n``` {.julia .cell-code}\np₀ = fromroots([1,3,5])\nst = ANewDsc(coeffs(p₀))\n```\n\n::: {.cell-output .cell-output-display execution_count=45}\n```\nThere were 3 isolating intervals found:\n[4.25…, 5.75…]₂₅₆\n[2.88…, 4.25…]₂₅₆\n[-0.5…, 2.88…]₂₅₆\n```\n:::\n:::\n\n\nThese intervals can be refined to give accurate approximations to the roots:\n\n::: {.cell execution_count=45}\n``` {.julia .cell-code}\nrefine_roots(st)\n```\n\n::: {.cell-output .cell-output-display execution_count=46}\n```\n3-element Vector{BigFloat}:\n 4.999999999999999999967490627846442540672989866698851128199972485011137735000375\n 3.000000000000000000009861182059785451385772340977725896178427810855743329554457\n 0.9999999999999999999958766210457915161935058296923676078991563769182386099486686\n```\n:::\n:::\n\n\nMore challenging problems can be readily handled by this package. The following polynomial\n\n::: {.cell execution_count=46}\n``` {.julia .cell-code}\n𝒔 = Polynomial([0,1]) # also just variable(Polynomial{Int})\n𝒖 = -1 + 254*𝒔 - 16129*𝒔^2 + 𝒔^15\n```\n\n::: {.cell-output .cell-output-display execution_count=47}\n```{=html}\n&#45;1 &#43; 254&#8729;x &#45; 16129&#8729;x<sup>2</sup> &#43; x<sup>15</sup>\n```\n:::\n:::\n\n\nhas three real roots, two of which are clustered very close to each other:\n\n::: {.cell execution_count=47}\n``` {.julia .cell-code}\n𝒔𝒕 = ANewDsc(coeffs(𝒖))\n```\n\n::: {.cell-output .cell-output-display execution_count=48}\n```\nThere were 3 isolating intervals found:\n[1.5…, 3.5…]₅₃\n[0.00787401574803149565556…, 0.00787401574803149757325…]₁₇₇\n[0.00787401574803149375397…, 0.00787401574803149565556…]₁₇₇\n```\n:::\n:::\n\n\nand\n\n::: {.cell execution_count=48}\n``` {.julia .cell-code}\nrefine_roots(𝒔𝒕)\n```\n\n::: {.cell-output .cell-output-display execution_count=49}\n```\n3-element Vector{BigFloat}:\n 2.105774229176482954311305578867363977387818158578515138040795165288093316116602\n 0.007874015748031497273373349924725911264911170253797198175318986022055185282220769\n 0.007874015748031494764060991187324015791492368160292970250334039637252529370366415\n```\n:::\n:::\n\n\nThe SymPy package (`sympy.real_roots`) can accurately identify the three roots but it can take a **very** long time. The `Polynomials.roots` function from the `Polynomials` package identifies the cluster as complex valued. Though the implementation in `RealPolynomialRoots` doesn't handle such large polynomials, the authors of the algorithm have implementations that can quickly solve polynomials with degrees as high as $10,000$.\n\n\n## Questions\n\n\n###### Question\n\n\nThe rational expression $(x^3 - 2x + 3) / (x^2 - x + 1)$ would have\n\n::: {.cell hold='true' execution_count=49}\n\n::: {.cell-output .cell-output-display execution_count=50}\n```{=html}\n<form class=\"mx-2 my-3 mw-100\" name='WeaveQuestion' data-id='14956752347591552614' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form\" id=\"controls_14956752347591552614\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_14956752347591552614_1\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_14956752347591552614\"\n              id=\"radio_14956752347591552614_1\" value=\"1\">\n      </input>\n      <span class=\"label-body px-1\">\n        A slant asymptote with slope \\(m=1\\)\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_14956752347591552614_2\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_14956752347591552614\"\n              id=\"radio_14956752347591552614_2\" value=\"2\">\n      </input>\n      <span class=\"label-body px-1\">\n        A horizontal asymptote \\(y=0\\)\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_14956752347591552614_3\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_14956752347591552614\"\n              id=\"radio_14956752347591552614_3\" value=\"3\">\n      </input>\n      <span class=\"label-body px-1\">\n        A horizontal asymptote \\(y=1\\)\n      </span>\n    </label>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='14956752347591552614_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.querySelectorAll('input[name=\"radio_14956752347591552614\"]').forEach(function(rb) {\nrb.addEventListener(\"change\", function() {\n    var correct = rb.value == 1;\n    var msgBox = document.getElementById('14956752347591552614_message');\n      if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_14956752347591552614\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_14956752347591552614\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n})});\n\n</script>\n```\n:::\n:::\n\n\n###### Question\n\n\nThe rational expression $(x^2 - x + 1)/ (x^3 - 2x + 3)$ would have\n\n::: {.cell hold='true' execution_count=50}\n\n::: {.cell-output .cell-output-display execution_count=51}\n```{=html}\n<form class=\"mx-2 my-3 mw-100\" name='WeaveQuestion' data-id='6131347255692596788' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form\" id=\"controls_6131347255692596788\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_6131347255692596788_1\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_6131347255692596788\"\n              id=\"radio_6131347255692596788_1\" value=\"1\">\n      </input>\n      <span class=\"label-body px-1\">\n        A slant asymptote with slope \\(m=1\\)\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_6131347255692596788_2\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_6131347255692596788\"\n              id=\"radio_6131347255692596788_2\" value=\"2\">\n      </input>\n      <span class=\"label-body px-1\">\n        A horizontal asymptote \\(y=1\\)\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_6131347255692596788_3\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_6131347255692596788\"\n              id=\"radio_6131347255692596788_3\" value=\"3\">\n      </input>\n      <span class=\"label-body px-1\">\n        A horizontal asymptote \\(y=0\\)\n      </span>\n    </label>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='6131347255692596788_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.querySelectorAll('input[name=\"radio_6131347255692596788\"]').forEach(function(rb) {\nrb.addEventListener(\"change\", function() {\n    var correct = rb.value == 3;\n    var msgBox = document.getElementById('6131347255692596788_message');\n      if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_6131347255692596788\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_6131347255692596788\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n})});\n\n</script>\n```\n:::\n:::\n\n\n###### Question\n\n\nThe rational expression $(x^2 - x + 1)/ (x^2 - 3x + 3)$ would have\n\n::: {.cell hold='true' execution_count=51}\n\n::: {.cell-output .cell-output-display execution_count=52}\n```{=html}\n<form class=\"mx-2 my-3 mw-100\" name='WeaveQuestion' data-id='1392348175996584438' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form\" id=\"controls_1392348175996584438\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_1392348175996584438_1\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_1392348175996584438\"\n              id=\"radio_1392348175996584438_1\" value=\"1\">\n      </input>\n      <span class=\"label-body px-1\">\n        A horizontal asymptote \\(y=1\\)\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_1392348175996584438_2\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_1392348175996584438\"\n              id=\"radio_1392348175996584438_2\" value=\"2\">\n      </input>\n      <span class=\"label-body px-1\">\n        A horizontal asymptote \\(y=0\\)\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_1392348175996584438_3\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_1392348175996584438\"\n              id=\"radio_1392348175996584438_3\" value=\"3\">\n      </input>\n      <span class=\"label-body px-1\">\n        A slant asymptote with slope \\(m=1\\)\n      </span>\n    </label>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='1392348175996584438_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.querySelectorAll('input[name=\"radio_1392348175996584438\"]').forEach(function(rb) {\nrb.addEventListener(\"change\", function() {\n    var correct = rb.value == 1;\n    var msgBox = document.getElementById('1392348175996584438_message');\n      if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_1392348175996584438\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_1392348175996584438\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n})});\n\n</script>\n```\n:::\n:::\n\n\n###### Question\n\n\nThe rational expression\n\n\n\n$$\n\\frac{(x-1)\\cdot(x-2)\\cdot(x-3)}{(x-4)\\cdot(x-5)\\cdot(x-6)}\n$$\n\n\nwould have\n\n::: {.cell hold='true' execution_count=52}\n\n::: {.cell-output .cell-output-display execution_count=53}\n```{=html}\n<form class=\"mx-2 my-3 mw-100\" name='WeaveQuestion' data-id='11035412087925083258' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form\" id=\"controls_11035412087925083258\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_11035412087925083258_1\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_11035412087925083258\"\n              id=\"radio_11035412087925083258_1\" value=\"1\">\n      </input>\n      <span class=\"label-body px-1\">\n        A slant asymptote with slope \\(m=1\\)\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_11035412087925083258_2\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_11035412087925083258\"\n              id=\"radio_11035412087925083258_2\" value=\"2\">\n      </input>\n      <span class=\"label-body px-1\">\n        A horizontal asymptote \\(y=1\\)\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_11035412087925083258_3\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_11035412087925083258\"\n              id=\"radio_11035412087925083258_3\" value=\"3\">\n      </input>\n      <span class=\"label-body px-1\">\n        A horizontal asymptote \\(y=0\\)\n      </span>\n    </label>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='11035412087925083258_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.querySelectorAll('input[name=\"radio_11035412087925083258\"]').forEach(function(rb) {\nrb.addEventListener(\"change\", function() {\n    var correct = rb.value == 2;\n    var msgBox = document.getElementById('11035412087925083258_message');\n      if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_11035412087925083258\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_11035412087925083258\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n})});\n\n</script>\n```\n:::\n:::\n\n\n###### Question\n\n\nThe rational expression\n\n\n\n$$\n\\frac{(x-1)\\cdot(x-2)\\cdot(x-3)}{(x-4)\\cdot(x-5)\\cdot(x-6)}\n$$\n\n\nwould have\n\n::: {.cell hold='true' execution_count=53}\n\n::: {.cell-output .cell-output-display execution_count=54}\n```{=html}\n<form class=\"mx-2 my-3 mw-100\" name='WeaveQuestion' data-id='2437376774069627981' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form\" id=\"controls_2437376774069627981\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_2437376774069627981_1\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_2437376774069627981\"\n              id=\"radio_2437376774069627981_1\" value=\"1\">\n      </input>\n      <span class=\"label-body px-1\">\n        A slant asymptote with slope \\(m=1\\)\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_2437376774069627981_2\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_2437376774069627981\"\n              id=\"radio_2437376774069627981_2\" value=\"2\">\n      </input>\n      <span class=\"label-body px-1\">\n        A vertical asymptote \\(x=5\\)\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_2437376774069627981_3\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_2437376774069627981\"\n              id=\"radio_2437376774069627981_3\" value=\"3\">\n      </input>\n      <span class=\"label-body px-1\">\n        A vertical asymptote \\(x=1\\)\n      </span>\n    </label>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='2437376774069627981_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.querySelectorAll('input[name=\"radio_2437376774069627981\"]').forEach(function(rb) {\nrb.addEventListener(\"change\", function() {\n    var correct = rb.value == 2;\n    var msgBox = document.getElementById('2437376774069627981_message');\n      if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_2437376774069627981\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_2437376774069627981\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n})});\n\n</script>\n```\n:::\n:::\n\n\n###### Question\n\n\nThe rational expression\n\n\n\n$$\n\\frac{x^3 - 3x^2 + 2x}{3x^2 - 6x + 2}\n$$\n\n\nhas a slant asymptote. What is the equation of that line?\n\n::: {.cell hold='true' execution_count=54}\n\n::: {.cell-output .cell-output-display execution_count=55}\n```{=html}\n<form class=\"mx-2 my-3 mw-100\" name='WeaveQuestion' data-id='3866560529594283453' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form\" id=\"controls_3866560529594283453\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_3866560529594283453_1\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_3866560529594283453\"\n              id=\"radio_3866560529594283453_1\" value=\"1\">\n      </input>\n      <span class=\"label-body px-1\">\n        \\(y = (1/3)x\\)\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_3866560529594283453_2\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_3866560529594283453\"\n              id=\"radio_3866560529594283453_2\" value=\"2\">\n      </input>\n      <span class=\"label-body px-1\">\n        \\(y = (1/3)x - (1/3)\\)\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_3866560529594283453_3\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_3866560529594283453\"\n              id=\"radio_3866560529594283453_3\" value=\"3\">\n      </input>\n      <span class=\"label-body px-1\">\n        \\(y = 3x\\)\n      </span>\n    </label>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='3866560529594283453_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.querySelectorAll('input[name=\"radio_3866560529594283453\"]').forEach(function(rb) {\nrb.addEventListener(\"change\", function() {\n    var correct = rb.value == 2;\n    var msgBox = document.getElementById('3866560529594283453_message');\n      if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_3866560529594283453\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_3866560529594283453\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n})});\n\n</script>\n```\n:::\n:::\n\n\n###### Question\n\n\nLook at the graph of the function $f(x) = ((x-1)\\cdot(x-2)) / ((x-3)\\cdot(x-4))$\n\n::: {.cell hold='true' execution_count=55}\n\n::: {.cell-output .cell-output-display execution_count=56}\n![](rational_functions_files/figure-html/cell-56-output-1.svg){}\n:::\n:::\n\n\nIs the following common conception true: \"The graph of a function never crosses its asymptotes.\"\n\n::: {.cell hold='true' execution_count=56}\n\n::: {.cell-output .cell-output-display execution_count=57}\n```{=html}\n<form class=\"mx-2 my-3 mw-100\" name='WeaveQuestion' data-id='12627761791981705101' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form\" id=\"controls_12627761791981705101\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_12627761791981705101_1\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_12627761791981705101\"\n              id=\"radio_12627761791981705101_1\" value=\"1\">\n      </input>\n      <span class=\"label-body px-1\">\n        Yes, this is true\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_12627761791981705101_2\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_12627761791981705101\"\n              id=\"radio_12627761791981705101_2\" value=\"2\">\n      </input>\n      <span class=\"label-body px-1\">\n        No, the graph clearly crosses the drawn asymptote\n      </span>\n    </label>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='12627761791981705101_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.querySelectorAll('input[name=\"radio_12627761791981705101\"]').forEach(function(rb) {\nrb.addEventListener(\"change\", function() {\n    var correct = rb.value == 2;\n    var msgBox = document.getElementById('12627761791981705101_message');\n      if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_12627761791981705101\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_12627761791981705101\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n})});\n\n</script>\n```\n:::\n:::\n\n\n(The wikipedia page indicates that the term \"asymptote\" was introduced by Apollonius of Perga in his work on conic sections, but in contrast to its modern meaning, he used it to mean any line that does not intersect the given curve. It can sometimes take a while to change perception.)\n\n\n###### Question\n\n\nConsider the two graphs of $f(x) = 1/x$ over $[10,20]$ and $[100, 200]$:\n\n::: {.cell hold='true' execution_count=57}\n\n::: {.cell-output .cell-output-display execution_count=58}\n![](rational_functions_files/figure-html/cell-58-output-1.svg){}\n:::\n:::\n\n\n::: {.cell hold='true' execution_count=58}\n\n::: {.cell-output .cell-output-display execution_count=59}\n![](rational_functions_files/figure-html/cell-59-output-1.svg){}\n:::\n:::\n\n\nThe two shapes are basically identical and do not look like straight lines. How does this reconcile with the fact that $f(x)=1/x$ has a horizontal asymptote $y=0$?\n\n::: {.cell hold='true' execution_count=59}\n\n::: {.cell-output .cell-output-display execution_count=60}\n```{=html}\n<form class=\"mx-2 my-3 mw-100\" name='WeaveQuestion' data-id='16386635379690246451' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form\" id=\"controls_16386635379690246451\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_16386635379690246451_1\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_16386635379690246451\"\n              id=\"radio_16386635379690246451_1\" value=\"1\">\n      </input>\n      <span class=\"label-body px-1\">\n        The horizontal asymptote is not a straight line.\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_16386635379690246451_2\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_16386635379690246451\"\n              id=\"radio_16386635379690246451_2\" value=\"2\">\n      </input>\n      <span class=\"label-body px-1\">\n        The \\(y\\)-axis scale shows that indeed the \\(y\\) values are getting close to \\(0\\).\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_16386635379690246451_3\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_16386635379690246451\"\n              id=\"radio_16386635379690246451_3\" value=\"3\">\n      </input>\n      <span class=\"label-body px-1\">\n        The graph is always decreasing, hence it will eventually reach \\(-\\infty\\).\n      </span>\n    </label>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='16386635379690246451_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.querySelectorAll('input[name=\"radio_16386635379690246451\"]').forEach(function(rb) {\nrb.addEventListener(\"change\", function() {\n    var correct = rb.value == 2;\n    var msgBox = document.getElementById('16386635379690246451_message');\n      if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_16386635379690246451\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_16386635379690246451\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n})});\n\n</script>\n```\n:::\n:::\n\n\n###### Question\n\n\nThe amount of drug in a bloodstream after $t$ hours is modeled by the rational function\n\n\n\n$$\nr(t) = \\frac{50t^2}{t^3 + 20}, \\quad t \\geq  0.\n$$\n\n\nWhat is the amount of the drug after $1$ hour?\n\n::: {.cell execution_count=60}\n\n::: {.cell-output .cell-output-display execution_count=61}\n```\nr1 (generic function with 1 method)\n```\n:::\n:::\n\n\n::: {.cell hold='true' execution_count=61}\n\n::: {.cell-output .cell-output-display execution_count=62}\n```{=html}\n<form class=\"mx-2 my-3 mw-100\" name='WeaveQuestion' data-id='15197105662500086796' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form\" id=\"controls_15197105662500086796\">\n        <div style=\"padding-top: 5px\">\n    </br>\n<div class=\"input-group\">\n    <input id=\"15197105662500086796\" type=\"number\" class=\"form-control\" placeholder=\"Numeric answer\">\n</div>\n\n    \n        </div>\n      </div>\n      <div id='15197105662500086796_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.getElementById(\"15197105662500086796\").addEventListener(\"change\", function() {\n  var correct = (Math.abs(this.value - 2.380952380952381) <= 0.001);\n  var msgBox = document.getElementById('15197105662500086796_message');\n    if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_15197105662500086796\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_15197105662500086796\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n});\n\n</script>\n```\n:::\n:::\n\n\nWhat is the amount of drug in the bloodstream after 24 hours?\n\n::: {.cell hold='true' execution_count=62}\n\n::: {.cell-output .cell-output-display execution_count=63}\n```{=html}\n<form class=\"mx-2 my-3 mw-100\" name='WeaveQuestion' data-id='4445583454786406540' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form\" id=\"controls_4445583454786406540\">\n        <div style=\"padding-top: 5px\">\n    </br>\n<div class=\"input-group\">\n    <input id=\"4445583454786406540\" type=\"number\" class=\"form-control\" placeholder=\"Numeric answer\">\n</div>\n\n    \n        </div>\n      </div>\n      <div id='4445583454786406540_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.getElementById(\"4445583454786406540\").addEventListener(\"change\", function() {\n  var correct = (Math.abs(this.value - 2.0803236058942502) <= 0.001);\n  var msgBox = document.getElementById('4445583454786406540_message');\n    if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_4445583454786406540\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_4445583454786406540\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n});\n\n</script>\n```\n:::\n:::\n\n\nWhat is more accurate: the peak amount is\n\n::: {.cell hold='true' execution_count=63}\n\n::: {.cell-output .cell-output-display execution_count=64}\n```{=html}\n<form class=\"mx-2 my-3 mw-100\" name='WeaveQuestion' data-id='6393257674212642129' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form\" id=\"controls_6393257674212642129\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_6393257674212642129_1\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_6393257674212642129\"\n              id=\"radio_6393257674212642129_1\" value=\"1\">\n      </input>\n      <span class=\"label-body px-1\">\n        after one day\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_6393257674212642129_2\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_6393257674212642129\"\n              id=\"radio_6393257674212642129_2\" value=\"2\">\n      </input>\n      <span class=\"label-body px-1\">\n        between \\(0\\) and \\(8\\) hours\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_6393257674212642129_3\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_6393257674212642129\"\n              id=\"radio_6393257674212642129_3\" value=\"3\">\n      </input>\n      <span class=\"label-body px-1\">\n        between \\(8\\) and \\(16\\) hours\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_6393257674212642129_4\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_6393257674212642129\"\n              id=\"radio_6393257674212642129_4\" value=\"4\">\n      </input>\n      <span class=\"label-body px-1\">\n        between \\(16\\) and \\(24\\) hours\n      </span>\n    </label>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='6393257674212642129_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.querySelectorAll('input[name=\"radio_6393257674212642129\"]').forEach(function(rb) {\nrb.addEventListener(\"change\", function() {\n    var correct = rb.value == 2;\n    var msgBox = document.getElementById('6393257674212642129_message');\n      if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_6393257674212642129\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_6393257674212642129\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n})});\n\n</script>\n```\n:::\n:::\n\n\nThis graph has\n\n::: {.cell hold='true' execution_count=64}\n\n::: {.cell-output .cell-output-display execution_count=65}\n```{=html}\n<form class=\"mx-2 my-3 mw-100\" name='WeaveQuestion' data-id='3443099540256967133' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form\" id=\"controls_3443099540256967133\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_3443099540256967133_1\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_3443099540256967133\"\n              id=\"radio_3443099540256967133_1\" value=\"1\">\n      </input>\n      <span class=\"label-body px-1\">\n        a horizontal asymptote \\(y=20\\)\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_3443099540256967133_2\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_3443099540256967133\"\n              id=\"radio_3443099540256967133_2\" value=\"2\">\n      </input>\n      <span class=\"label-body px-1\">\n        a horizontal asymptote \\(y=0\\)\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_3443099540256967133_3\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_3443099540256967133\"\n              id=\"radio_3443099540256967133_3\" value=\"3\">\n      </input>\n      <span class=\"label-body px-1\">\n        a slant asymptote with slope \\(50\\)\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_3443099540256967133_4\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_3443099540256967133\"\n              id=\"radio_3443099540256967133_4\" value=\"4\">\n      </input>\n      <span class=\"label-body px-1\">\n        a vertical asymptote with \\(x = 20^{1/3}\\)\n      </span>\n    </label>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='3443099540256967133_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.querySelectorAll('input[name=\"radio_3443099540256967133\"]').forEach(function(rb) {\nrb.addEventListener(\"change\", function() {\n    var correct = rb.value == 2;\n    var msgBox = document.getElementById('3443099540256967133_message');\n      if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_3443099540256967133\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_3443099540256967133\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n})});\n\n</script>\n```\n:::\n:::\n\n\n###### Question\n\n\nThe (low-order) Pade approximation for $\\sin(x)$ was seen to be $(x - 7/60 \\cdot x^3)/(1 + 1/20 \\cdot x^2)$. The graph showed that this approximation was fairly close over $[-\\pi, \\pi]$. Without graphing would you expect the behaviour of the function and its approximation to be similar for *large* values of $x$?\n\n::: {.cell hold='true' execution_count=65}\n\n::: {.cell-output .cell-output-display execution_count=66}\n```{=html}\n<form class=\"mx-2 my-3 mw-100\" name='WeaveQuestion' data-id='16656448479718557829' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form\" id=\"controls_16656448479718557829\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_16656448479718557829_1\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_16656448479718557829\"\n              id=\"radio_16656448479718557829_1\" value=\"1\">\n      </input>\n      <span class=\"label-body px-1\">\n        Yes\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_16656448479718557829_2\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_16656448479718557829\"\n              id=\"radio_16656448479718557829_2\" value=\"2\">\n      </input>\n      <span class=\"label-body px-1\">\n        No\n      </span>\n    </label>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='16656448479718557829_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.querySelectorAll('input[name=\"radio_16656448479718557829\"]').forEach(function(rb) {\nrb.addEventListener(\"change\", function() {\n    var correct = rb.value == 2;\n    var msgBox = document.getElementById('16656448479718557829_message');\n      if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_16656448479718557829\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_16656448479718557829\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n})});\n\n</script>\n```\n:::\n:::\n\n\nWhy?\n\n::: {.cell hold='true' execution_count=66}\n\n::: {.cell-output .cell-output-display execution_count=67}\n```{=html}\n<form class=\"mx-2 my-3 mw-100\" name='WeaveQuestion' data-id='3696604232591050667' data-controltype=''>\n  <div class='form-group '>\n    <div class='controls'>\n      <div class=\"form\" id=\"controls_3696604232591050667\">\n        <div style=\"padding-top: 5px\">\n    <div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_3696604232591050667_1\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_3696604232591050667\"\n              id=\"radio_3696604232591050667_1\" value=\"1\">\n      </input>\n      <span class=\"label-body px-1\">\n        The \\(\\sin(x)\\) oscillates, but the rational function has a horizontal asymptote of \\(0\\)\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_3696604232591050667_2\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_3696604232591050667\"\n              id=\"radio_3696604232591050667_2\" value=\"2\">\n      </input>\n      <span class=\"label-body px-1\">\n        The \\(\\sin(x)\\) oscillates, but the rational function has a non-zero horizontal asymptote\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_3696604232591050667_3\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_3696604232591050667\"\n              id=\"radio_3696604232591050667_3\" value=\"3\">\n      </input>\n      <span class=\"label-body px-1\">\n        The \\(\\sin(x)\\) oscillates, but the rational function eventually follows \\(7/60 \\cdot x^3\\)\n      </span>\n    </label>\n</div>\n<div class=\"form-check\">\n    <label class=\"form-check-label\" for=\"radio_3696604232591050667_4\">\n      <input class=\"form-check-input\" type=\"radio\" name=\"radio_3696604232591050667\"\n              id=\"radio_3696604232591050667_4\" value=\"4\">\n      </input>\n      <span class=\"label-body px-1\">\n        The \\(\\sin(x)\\) oscillates, but the rational function has a slant asymptote\n      </span>\n    </label>\n</div>\n\n    \n        </div>\n      </div>\n      <div id='3696604232591050667_message' style=\"padding-bottom: 15px\"></div>\n    </div>\n  </div>\n</form>\n\n<script text='text/javascript'>\ndocument.querySelectorAll('input[name=\"radio_3696604232591050667\"]').forEach(function(rb) {\nrb.addEventListener(\"change\", function() {\n    var correct = rb.value == 4;\n    var msgBox = document.getElementById('3696604232591050667_message');\n      if(correct) {\n    msgBox.innerHTML = \"<div class='pluto-output admonition note alert alert-success'><span> 👍&nbsp; Correct </span></div>\";\n    var explanation = document.getElementById(\"explanation_3696604232591050667\")\n    if (explanation != null) {\n       explanation.style.display = \"none\";\n    }\n  } else {\n    msgBox.innerHTML = \"<div class='pluto-output admonition alert alert-danger'><span>👎&nbsp; Incorrect </span></div>\";\n    var explanation = document.getElementById(\"explanation_3696604232591050667\")\n    if (explanation != null) {\n       explanation.style.display = \"block\";\n    }\n  }\n\n})});\n\n</script>\n```\n:::\n:::\n\n\n",
    "supporting": [
      "rational_functions_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}